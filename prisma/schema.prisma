generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

//
// ENUMS
//
enum Role {
  FREELANCER
  CLIENT
}

enum ExperienceLevel {
  EXPERT
  INTERMEDIATE
  ENTRY
}

enum Category {
  ACCOUNTING
  ADMIN_SUPPORT
  CUSTOMER_SERVICE
  DATA_SCIENCE
  DESIGN_CREATIVE
  ENGINEERING
  IT_NETWORKING
  LEGAL
  SALES_MARKETING
  TRANSLATION
  SOFTWARE_DEV
  WRITING
}

enum Speciality {
  ECOMMERCE
  DESKTOP_SOFTWARE
  SCRIPTING_AUTOMATION
  MANUAL_TESTING
  AUTOMATION_TESTING
  AI_CHATBOT
  AI_INTEGRATION
  PROTOTYPING
  MOBILE_DESIGN
  WEB_DESIGN
  UX_UI
  MOBILE_APP
  MOBILE_GAME
  CRYPTO_TOKENS
  BLOCKCHAIN_NFT
  CRYPTO_WALLET
  SCRUM
  PRODUCT_MANAGEMENT
  FIRMWARE
  EMERGING_TECH
  AR_VR
  CODING_TUTORING
  DATABASE_DEV
  BACKEND_DEV
  FRONTEND_DEV
  FULLSTACK_DEV
  CMS_DEV
  GAME_DEV
}

enum JobStatus {
  OPEN
  IN_PROGRESS
  COMPLETED
  CANCELLED
}

enum ScopeSize {
  SMALL
  MEDIUM
  LARGE
}

enum ScopeDuration {
  ONE_TO_THREE_MONTHS
  THREE_TO_SIX_MONTHS
  MORE_THAN_SIX_MONTHS
}

enum ProposalStatus {
  PENDING
  ACCEPTED
  REJECTED
  WITHDRAWN
}

//
// MODELS
//
model User {
  id            String    @id @default(uuid())
  firstName     String
  lastName      String
  email         String    @unique
  password      String
  country       String
  emailVerified Boolean   @default(false)
  role          Role
  profileImage  String?
  emailOTP      String?
  otpExpiresAt  DateTime?
  createdAt     DateTime  @default(now())

  // Relations
  freelancerProfile FreelancerProfile?
  clientProfile     ClientProfile?
}

model FreelancerProfile {
  id         String  @id @default(uuid())
  user       User    @relation(fields: [userId], references: [id])
  userId     String  @unique
  available  Boolean @default(true)
  mobile     String
  profession String
  bio        String

  skills          String[]
  perHourRate     Float
  languages       String // comma separated
  portfolioLink   String?
  otherLink       String?
  experienceLevel ExperienceLevel
  file            String? // resume or cover document
  connects        Int @default(200)

  // Relations
  savedJobs Job[]      @relation("SavedJobs")
  proposals Proposal[]
  hiredJobs Job[]      @relation("HiredJobs")
}

model ClientProfile {
  id          String  @id @default(uuid())
  user        User    @relation(fields: [userId], references: [id])
  userId      String  @unique
  mobile      String
  company     String
  websiteLink String?
  location    String
  rating      Float? // future use

  // Relations
  postedJobs Job[]
}

model Job {
  id                String     @id @default(uuid())
  title             String
  description       String
  category          Category
  speciality        Speciality
  skills            String[]
  budget            Float
  status            JobStatus  @default(OPEN)
  numberOfProposals Int        @default(0)
  completed         Boolean    @default(false)

  scopeSize        ScopeSize
  duration         ScopeDuration
  experience       ExperienceLevel
  createdAt        DateTime        @default(now())
  connectsRequired Int             @default(1)

  // Relations
  client   ClientProfile @relation(fields: [clientId], references: [id])
  clientId String

  hiredFreelancer   FreelancerProfile? @relation("HiredJobs", fields: [hiredFreelancerId], references: [id])
  hiredFreelancerId String?

  proposals Proposal[]
  savedBy   FreelancerProfile[] @relation("SavedJobs")
}

// duration enum
enum EstimatedDuration{
  ONE_TO_THREE_MONTHS
  THREE_TO_SIX_MONTHS
  MORE_THAN_SIX_MONTHS
  LESS_THEN_ONE_MONTHS
}

model Proposal {
  id          String         @id @default(uuid())
  coverLetter String
  message     String?
  rate        Float
  duration    EstimatedDuration
  attachedFile String?
  createdAt   DateTime       @default(now())
  status      ProposalStatus @default(PENDING)
  submittedAt DateTime       @default(now())

  // Relations
  freelancerProfile   FreelancerProfile @relation(fields: [freelancerProfileId], references: [id])
  freelancerProfileId String

  job   Job    @relation(fields: [jobId], references: [id])
  jobId String
}
